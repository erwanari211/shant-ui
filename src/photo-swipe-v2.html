<!DOCTYPE html>
<!--
* CoreUI - Free Bootstrap Admin Template
* @version v2.1.15
* @link https://coreui.io
* Copyright (c) 2018 creativeLabs Łukasz Holeczek
* Licensed under MIT (https://coreui.io/license)
-->

<html lang="en">
  <head>
    <base href="./">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <meta name="description" content="CoreUI - Open Source Bootstrap Admin Template">
    <meta name="author" content="Łukasz Holeczek">
    <meta name="keyword" content="Bootstrap,Admin,Template,Open,Source,jQuery,CSS,HTML,RWD,Dashboard">
    <title>CoreUI Free Bootstrap Admin Template</title>
    <!-- Icons-->
    <link rel="icon" type="image/ico" href="./img/favicon.ico" sizes="any" />
    <link href="node_modules/@coreui/icons/css/coreui-icons.min.css" rel="stylesheet">
    <link href="node_modules/flag-icon-css/css/flag-icon.min.css" rel="stylesheet">
    <link href="node_modules/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="node_modules/simple-line-icons/css/simple-line-icons.css" rel="stylesheet">

    <!-- styles required by this view-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.css">

    <style>
      .image-gallery {
        width: 100%;
        float: left;
      }
      .image-gallery img {
        width: 100%;
        height: auto;
      }
      /* .image-gallery figure {
        display: block;
        float: left;
        margin: 0 5px 5px 0;
        width: 150px;
      } */
      .image-gallery figure {
        display: block;
        float: left;
        width: 23%;
        margin: 0 1%;
        /* margin: 0 5px 5px 0;
        width: 150px; */
      }
      /* .image-gallery figure div {
        display: block;
        float: left;
        height: 150px;
      }
      .image-gallery figure div img {
        height: 100%;
      } */
      .image-gallery figcaption {
        display: none;
      }

      .image-wrapper {
        height: 240px;
        width: 240px;
        background-color: #eee;
        display: block;
        min-height: 100px;
        margin-bottom: 8px;
        position: relative;
        display: block;
        overflow: hidden;
      }

      .image-wrapper img {
        display: block;
        max-width: 100%;
        position: absolute;
        margin: auto;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        height: auto;
        max-height: 120%;
      }
    </style>

    <!-- Main styles for this application-->
    <link href="css/style.css" rel="stylesheet">
    <link href="vendors/pace-progress/css/pace.min.css" rel="stylesheet">

    <!-- Global site tag (gtag.js) - Google Analytics-->
    <script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-118965717-3"></script>
    <script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      // Shared ID
      gtag('config', 'UA-118965717-3');
      // Bootstrap ID
      gtag('config', 'UA-118965717-5');
    </script>
  </head>
  <body class="app header-fixed sidebar-fixed aside-menu-fixed sidebar-lg-show">
    <include src="partials/header.html"></include>
    <div class="app-body">
      <include src="partials/sidebar.html"></include>
      <main class="main">
        <include src="partials/breadcrumb.html"></include>
        <div class="container-fluid">
          <div class="animated fadeIn">

            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-header">Header</div>
                  <div class="card-body">
                    <div class="row">
                      <div class="col-sm-12">


                        <h2>Third gallery:</h2>
                        <div class="image-gallery">
                          <figure>
                            <div class="image-wrapper" href="https://farm7.staticflickr.com/6175/6176698785_7dee72237e_b.jpg" data-size="1024x683">
                              <img class="" src="https://farm7.staticflickr.com/6175/6176698785_7dee72237e_m.jpg" alt="Image description" />
                            </div>
                            <figcaption>
                              Image caption 3.1 <br>
                              <span>Lorem ipsum dolor sit amet consectetur, adipisicing elit. Officia, similique.</span>
                              <span>Impedit assumenda modi quibusdam molestias ea quam labore nisi doloribus!</span>
                              <br>
                              <small>Officiis, placeat! Consectetur</small>
                            </figcaption>
                          </figure>
                          <figure>
                            <div class="image-wrapper" href="https://farm6.staticflickr.com/5023/5578283926_822e5e5791_b.jpg" data-size="1024x768">
                              <img class="" src="https://farm6.staticflickr.com/5023/5578283926_822e5e5791_m.jpg" alt="Image description" />
                            </div>
                            <figcaption>
                              Image caption 3.2 <br>
                              <span>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Rem, exercitationem.</span>
                              <span>Quibusdam dolor nesciunt architecto facilis ea molestias quam quaerat libero?</span>
                              <br>
                              <small>Quo velit veritatis</small>
                            </figcaption>
                          </figure>
                          <figure>
                            <div class="image-wrapper" href="https://farm2.staticflickr.com/1043/5186867718_06b2e9e551_b.jpg" data-size="964x1024">
                              <img class="" src="https://farm2.staticflickr.com/1043/5186867718_06b2e9e551_m.jpg" alt="Image description" />
                            </div>
                            <figcaption>
                              Image caption 3.3 <br>
                              <span>Lorem ipsum dolor sit amet consectetur adipisicing elit. Asperiores, vitae?</span>
                              <span>Officia iste doloribus atque voluptatibus numquam accusantium esse earum veniam.</span>
                              <br>
                              <small>Architecto aliquam iusto</small>
                            </figcaption>
                          </figure>
                        </div>

                        <!-- Root element of PhotoSwipe. Must have class pswp. -->
                        <div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
                          <div class="pswp__bg"></div>
                          <div class="pswp__scroll-wrap">
                            <div class="pswp__container">
                              <div class="pswp__item"></div>
                              <div class="pswp__item"></div>
                              <div class="pswp__item"></div>
                            </div>

                            <div class="pswp__ui pswp__ui--hidden">
                              <div class="pswp__top-bar">
                                <div class="pswp__counter"></div>
                                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                                <button class="pswp__button pswp__button--share" title="Share"></button>
                                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                                <div class="pswp__preloader">
                                  <div class="pswp__preloader__icn">
                                    <div class="pswp__preloader__cut">
                                      <div class="pswp__preloader__donut"></div>
                                    </div>
                                  </div>
                                </div>
                              </div>

                              <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                                <div class="pswp__share-tooltip"></div>
                              </div>

                              <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
                              </button>
                              <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
                              </button>

                              <div class="pswp__caption">
                                <div class="pswp__caption__center"></div>
                              </div>
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- /.col-->
            </div>
            <!-- /.row-->
          </div>
        </div>
      </main>
      <include src="partials/aside.html"></include>
    </div>
    <include src="partials/footer.html"></include>
    <!-- CoreUI and necessary plugins-->
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/popper.js/dist/umd/popper.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="node_modules/pace-progress/pace.min.js"></script>
    <script src="node_modules/perfect-scrollbar/dist/perfect-scrollbar.min.js"></script>
    <script src="node_modules/@coreui/coreui/dist/js/coreui.min.js"></script>

    <!-- Plugins and scripts required by this view-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>
    <script>
      var initPhotoSwipeFromDOM = function(gallerySelector) {
        console.log('1. gallerySelector', gallerySelector)

        // parse slide data (url, title, size ...) from DOM elements
        // (children of gallerySelector)
        var parseThumbnailElements = function(el) {
          console.log('2. el', el)
          var thumbElements = el.childNodes,
              numNodes = thumbElements.length,
              items = [],
              figureEl,
              linkEl,
              size,
              item;
              console.log('3. thumbElements', thumbElements)
              console.log('4. numNodes', numNodes)

          for(var i = 0; i < numNodes; i++) {
            figureEl = thumbElements[i]; // <figure> element
            console.log('5. figureEl', figureEl);

            // include only element nodes
            if(figureEl.nodeType !== 1) {
              console.log('6. nodeType 1');
              continue;
            }

            linkEl = figureEl.children[0]; // <a> element
            console.log('7. linkEl', linkEl) // div image wrapper

            size = linkEl.getAttribute('data-size').split('x');
            console.log('8. size', size)

            // create slide object
            item = {
              src: linkEl.getAttribute('href'),
              w: parseInt(size[0], 10),
              h: parseInt(size[1], 10)
            };
            console.log('9. item', item)

            if(figureEl.children.length > 1) {
              // <figcaption> content
              item.title = figureEl.children[1].innerHTML;
              console.log('10. item.title', item.title)
            }

            if(linkEl.children.length > 0) {
              // <img> thumbnail element, retrieving thumbnail url
              item.msrc = linkEl.children[0].getAttribute('src');
            }

            item.el = figureEl; // save link to element for getThumbBoundsFn
            console.log('11. item', item)
            items.push(item);
          }

          return items;
        };

        // find nearest parent element
        var closest = function closest(el, fn) {
          return el && ( fn(el) ? el : closest(el.parentNode, fn) );
        };

        // triggers when user clicks on thumbnail
        var onThumbnailsClick = function(e) {
          console.log(12)
          e = e || window.event;
          e.preventDefault ? e.preventDefault() : e.returnValue = false;

          var eTarget = e.target || e.srcElement;
          console.log('12. eTarget', eTarget)

          // find root element of slide
          var clickedListItem = closest(eTarget, function(el) {
            console.log(el.tagName)
            return (el.tagName && el.tagName.toUpperCase() === 'FIGURE');
          });

          if(!clickedListItem) {
            return;
          }
          console.log(13)
          console.log('13 clickedListItem', clickedListItem)

          // find index of clicked item by looping through all child nodes
          // alternatively, you may define index via data- attribute
          var clickedGallery = clickedListItem.parentNode,
              childNodes = clickedListItem.parentNode.childNodes,
              numChildNodes = childNodes.length,
              nodeIndex = 0,
              index;
              console.log('14. clickedGallery', clickedGallery)
              console.log('14. numChildNodes', numChildNodes)
              console.log('14. childNodes', childNodes)

          for (var i = 0; i < numChildNodes; i++) {
            if(childNodes[i].nodeType !== 1) {
              continue;
            }

            if(childNodes[i] === clickedListItem) {
              console.log('15. nodeType', childNodes[i].nodeType)
              console.log('15. clickedListItem', clickedListItem)
              index = nodeIndex;
              break;
            }
            nodeIndex++;
          }



          if(index >= 0) {
            // open PhotoSwipe if valid index found
            openPhotoSwipe( index, clickedGallery );
          }
          return false;
        };

        // parse picture index and gallery index from URL (#&pid=1&gid=2)
        var photoswipeParseHash = function() {
          var hash = window.location.hash.substring(1),
          params = {};

          if(hash.length < 5) {
            return params;
          }

          var vars = hash.split('&');
          for (var i = 0; i < vars.length; i++) {
            if(!vars[i]) {
              continue;
            }
            var pair = vars[i].split('=');
            if(pair.length < 2) {
              continue;
            }
            params[pair[0]] = pair[1];
          }

          if(params.gid) {
            params.gid = parseInt(params.gid, 10);
          }

          return params;
        };

        var openPhotoSwipe = function(index, galleryElement, disableAnimation, fromURL) {
          var pswpElement = document.querySelectorAll('.pswp')[0],
              gallery,
              options,
              items;

          items = parseThumbnailElements(galleryElement);

          // define options (if needed)
          options = {

            // define gallery index (for URL)
            galleryUID: galleryElement.getAttribute('data-pswp-uid'),

            getThumbBoundsFn: function(index) {
              // See Options -> getThumbBoundsFn section of documentation for more info
              var thumbnail = items[index].el.getElementsByTagName('img')[0], // find thumbnail
                  pageYScroll = window.pageYOffset || document.documentElement.scrollTop,
                  rect = thumbnail.getBoundingClientRect();

              return {x:rect.left, y:rect.top + pageYScroll, w:rect.width};
            }

          };

          // PhotoSwipe opened from URL
          if(fromURL) {
            if(options.galleryPIDs) {
              // parse real index when custom PIDs are used
              // http://photoswipe.com/documentation/faq.html#custom-pid-in-url
              for(var j = 0; j < items.length; j++) {
                if(items[j].pid == index) {
                  options.index = j;
                  break;
                }
              }
            } else {
              // in URL indexes start from 1
              options.index = parseInt(index, 10) - 1;
            }
          } else {
            options.index = parseInt(index, 10);
          }

          // exit if index not found
          if( isNaN(options.index) ) {
            return;
          }

          if(disableAnimation) {
            options.showAnimationDuration = 0;
          }

          // Pass data to PhotoSwipe and initialize it
          gallery = new PhotoSwipe( pswpElement, PhotoSwipeUI_Default, items, options);
          gallery.init();
        };

        // loop through all gallery elements and bind events
        var galleryElements = document.querySelectorAll( gallerySelector );

        for(var i = 0, l = galleryElements.length; i < l; i++) {
          galleryElements[i].setAttribute('data-pswp-uid', i+1);
          galleryElements[i].onclick = onThumbnailsClick;
        }

        // Parse URL and open gallery if it contains #&pid=3&gid=1
        var hashData = photoswipeParseHash();
        if(hashData.pid && hashData.gid) {
          openPhotoSwipe( hashData.pid ,  galleryElements[ hashData.gid - 1 ], true, true );
        }
      };

      // execute above function
      initPhotoSwipeFromDOM('.image-gallery');
    </script>
    <script>
      let includeTags = document.getElementsByTagName("include");

      for (let tags of includeTags) {
        fetch(tags.attributes["src"].value /*, options */)
          .then((response) => response.text())
          .then((html) => {
            tags.innerHTML = html;
          })
          .catch((error) => {
            console.warn(error);
          });
      }
    </script>
  </body>
</html>
